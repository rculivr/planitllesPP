{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/global","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/webpack/runtime/publicPath","webpack://office-addin-taskpane-js/webpack/runtime/jsonp chunk loading","webpack://office-addin-taskpane-js/./src/taskpane/custom_labels.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.html"],"sourcesContent":["// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/^blob:/, \"\").replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","__webpack_require__.b = document.baseURI || self.location.href;\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t926: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// no jsonp function","export const customLabelMap = {\r\n  any: () => new Date().getFullYear().toString(),\r\n  mes: () => {\r\n    const mesosCatalans = [\r\n      \"gener\",\r\n      \"febrer\",\r\n      \"mar√ß\",\r\n      \"abril\",\r\n      \"maig\",\r\n      \"juny\",\r\n      \"juliol\",\r\n      \"agost\",\r\n      \"setembre\",\r\n      \"octubre\",\r\n      \"novembre\",\r\n      \"desembre\",\r\n    ];\r\n    return mesosCatalans[new Date().getMonth()];\r\n  },\r\n  dia: () => new Date().getDate().toString().padStart(2, \"0\"),\r\n  any_passat: () => (new Date().getFullYear() - 1).toString(),\r\n};\r\n","import { customLabelMap } from \"./custom_labels.js\";\r\n\r\nOffice.onReady(() => {\r\n  scanLabels();\r\n  document.getElementById(\"scanLabelsButton\").onclick = scanLabels;\r\n  document.getElementById(\"labelForm\").onsubmit = handleFormSubmit;\r\n  document.getElementById(\"newSlideForm\").onsubmit = handleNewSlideSubmit;\r\n  document.getElementById(\"toggleSlideForm\").onsubmit = handleToggleSlideSubmit;\r\n});\r\n\r\nasync function findPattern(pattern) {\r\n  let foundLabels = new Map();\r\n  await PowerPoint.run(async (context) => {\r\n    const presentation = context.presentation;\r\n    const slides = presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n\r\n    for (let slide of slides.items) {\r\n      let shapes = slide.shapes;\r\n      shapes.load(\"items\");\r\n      await context.sync();\r\n\r\n      for (let shape of shapes.items) {\r\n        try {\r\n          shape.textFrame.load(\"textRange/text\");\r\n          await context.sync();\r\n\r\n          const text = shape.textFrame.textRange.text;\r\n          const matches = [...text.matchAll(pattern)];\r\n          if (matches.length > 0) {\r\n            console.log(\"Match: \", matches);\r\n          }\r\n\r\n          for (const match of matches) {\r\n            const customLabelName = match[1];\r\n            const imageLabelName = match[2];\r\n            const labelName = match[3];\r\n            const dependsOn = match[4];\r\n            const dependentValues = match[5];\r\n            const options = match[6];\r\n\r\n            if (customLabelName) {\r\n              const key = `#${customLabelName}`;\r\n              if (!foundLabels.has(key)) {\r\n                foundLabels.set(key, { type: \"custom\" });\r\n              }\r\n            }\r\n            if (imageLabelName) {\r\n              const key = `*${imageLabelName}`;\r\n              if (!foundLabels.has(key)) {\r\n                foundLabels.set(key, { type: \"image\" });\r\n              }\r\n            }\r\n            if (labelName) {\r\n              const key = labelName;\r\n              if (dependsOn && dependentValues) {\r\n                const values = dependentValues.split(\",\").map((v) => v.trim());\r\n                if (!foundLabels.has(key)) {\r\n                  foundLabels.set(key, {\r\n                    options: null,\r\n                    dependsOn,\r\n                    map: values,\r\n                  });\r\n                }\r\n              } else if (options) {\r\n                const opts = options.split(\",\").map((v) => v.trim());\r\n                if (!foundLabels.has(key)) {\r\n                  foundLabels.set(key, {\r\n                    options: opts,\r\n                    dependsOn: null,\r\n                    map: null,\r\n                  });\r\n                }\r\n              } else {\r\n                if (!foundLabels.has(key)) {\r\n                  foundLabels.set(key, {\r\n                    options: null,\r\n                    dependsOn: null,\r\n                    map: null,\r\n                  });\r\n                }\r\n              }\r\n            }\r\n          }\r\n        } catch (error) {}\r\n      }\r\n    }\r\n  });\r\n\r\n  return foundLabels;\r\n}\r\n\r\nasync function scanLabels() {\r\n  clearErrors();\r\n  const pattern = /<<#(\\w+)>>|<<\\*(\\w+)>>|<<(\\w+)(?::(\\w+)\\[([^\\]]+)\\]|(?:\\[([^\\]]+)\\]))?>>/g;\r\n  let foundLabels = await findPattern(pattern);\r\n  console.log(\"Found labels: \", foundLabels);\r\n\r\n  validatedLabels = new Map();\r\n  validatedLabels = checkLabels(foundLabels);\r\n  console.log(\"Validated\", validatedLabels);\r\n\r\n  await createToggleSlideForm();\r\n  createInputFields(validatedLabels);\r\n}\r\n\r\nlet validatedLabels = new Map();\r\nfunction checkLabels(foundLabels) {\r\n  for (const [name, label] of foundLabels) {\r\n    if (name.startsWith(\"#\") && !customLabelMap.hasOwnProperty(name.substring(1))) {\r\n      showError(`<<#${name.substring(1)}>> no existeix!`);\r\n      continue;\r\n    }\r\n    if (label.dependsOn) {\r\n      if (!foundLabels.has(label.dependsOn)) {\r\n        showError(`<<${label.dependsOn}>> no existeix!`);\r\n        continue;\r\n      }\r\n      if (foundLabels.get(label.dependsOn)[\"options\"].length !== label.map.length) {\r\n        showError(`El nombe d'opcions de <<${name}>> i <<${label.dependsOn}>> ha de ser igual!`);\r\n        continue;\r\n      }\r\n      if (!validatedLabels.has(name)) {\r\n        validatedLabels.set(name, label);\r\n      }\r\n    } else if (label.options) {\r\n      validatedLabels.set(name, label);\r\n    } else {\r\n      validatedLabels.set(name, label);\r\n    }\r\n  }\r\n  return validatedLabels;\r\n}\r\n\r\nasync function handleFormSubmit(event) {\r\n  event.preventDefault();\r\n\r\n  const labelMap = {};\r\n\r\n  // Helper to convert file to base64\r\n  function fileToBase64(file) {\r\n    return new Promise((resolve, reject) => {\r\n      const reader = new FileReader();\r\n      reader.onload = () => resolve(reader.result.split(\",\")[1]); // Remove data:image/...;base64,\r\n      reader.onerror = reject;\r\n      reader.readAsDataURL(file);\r\n    });\r\n  }\r\n\r\n  // Collect all file input promises\r\n  const filePromises = [];\r\n\r\n  validatedLabels.forEach((label, name) => {\r\n    if (label.dependsOn && label.map) {\r\n      const sourceInput = document.getElementById(label.dependsOn);\r\n      if (sourceInput) {\r\n        const selectedIndex = sourceInput.selectedIndex;\r\n        labelMap[name] = label.map[selectedIndex];\r\n      }\r\n    } else if (name.startsWith(\"*\")) {\r\n      const fileInput = document.getElementById(name);\r\n      if (fileInput && fileInput.files.length > 0) {\r\n        // Push a promise to convert file to base64\r\n        filePromises.push(\r\n          fileToBase64(fileInput.files[0]).then((base64) => {\r\n            labelMap[name] = base64;\r\n          })\r\n        );\r\n      }\r\n    } else {\r\n      const input = document.getElementById(name);\r\n      if (input) {\r\n        labelMap[name] = input.value;\r\n      }\r\n    }\r\n  });\r\n\r\n  // Wait for all file conversions\r\n  await Promise.all(filePromises);\r\n\r\n  console.log(\"Final labelMap:\", labelMap);\r\n  await replaceLabels(labelMap);\r\n}\r\n\r\nlet originalTexts = new Map(); // Store original text for undo\r\n\r\nasync function replaceLabels(labelMap) {\r\n  originalTexts.clear(); // Clear previous state\r\n  await PowerPoint.run(async (context) => {\r\n    const slides = context.presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n\r\n    const pattern = /<<#(\\w+)>>|<<\\*(\\w+)>>|<<(\\w+)(?::(\\w+)\\[([^\\]]+)\\]|(?:\\[([^\\]]+)\\]))?>>/g;\r\n    for (let slideIdx = 0; slideIdx < slides.items.length; slideIdx++) {\r\n      const slide = slides.items[slideIdx];\r\n      const shapes = slide.shapes;\r\n      shapes.load(\"items\");\r\n      await context.sync();\r\n\r\n      for (let shapeIdx = 0; shapeIdx < shapes.items.length; shapeIdx++) {\r\n        try {\r\n          const shape = shapes.items[shapeIdx];\r\n          shape.textFrame.load(\"textRange/text\");\r\n          await context.sync();\r\n\r\n          const textRange = shape.textFrame.textRange;\r\n          const text = textRange.text;\r\n\r\n          const matches = [...text.matchAll(pattern)];\r\n\r\n          const replacements = [];\r\n          for (let i = matches.length - 1; i >= 0; i--) {\r\n            const match = matches[i];\r\n            const fullMatch = match[0];\r\n            const customLabelName = match[1]; // <<#name>>\r\n            const imageLabelName = match[2]; // <<*name>>\r\n            const labelName = match[3]; // <<labelName...>>\r\n            const dependsOn = match[4];\r\n            const dependentValues = match[5];\r\n            const options = match[6];\r\n\r\n            let replacementValue = null;\r\n\r\n            if (customLabelName && customLabelMap.hasOwnProperty(customLabelName)) {\r\n              replacementValue = customLabelMap[customLabelName]();\r\n            } else if (imageLabelName && labelMap[`*${imageLabelName}`]) {\r\n              // Replace the shape with an image if <<*name>> is found\r\n              const base64 = labelMap[`*${imageLabelName}`];\r\n              // Remove the label text\r\n              const subRange = textRange.getSubstring(match.index, fullMatch.length);\r\n              subRange.text = \"\";\r\n              // Set the image as fill (if possible)\r\n              await shape.fill.setImage(base64);\r\n              // Store the replacement for undo (removes label text, not image)\r\n              replacements.push({\r\n                index: match.index,\r\n                original: fullMatch,\r\n                replaced: \"\",\r\n              });\r\n              continue; // Skip further text replacement for this match\r\n            } else if (dependsOn && dependentValues) {\r\n              const sourceValue = labelMap[dependsOn];\r\n              const values = dependentValues.split(\",\").map((v) => v.trim());\r\n              const sourceOptions = validatedLabels.get(dependsOn)?.options || [];\r\n              const index = sourceOptions.indexOf(sourceValue);\r\n              if (index !== -1 && index < values.length) {\r\n                replacementValue = values[index];\r\n              }\r\n            } else if (labelName) {\r\n              replacementValue = labelMap[labelName];\r\n            }\r\n\r\n            if (replacementValue !== null && replacementValue !== undefined) {\r\n              const subRange = textRange.getSubstring(match.index, fullMatch.length);\r\n              subRange.text = replacementValue;\r\n              replacements.push({\r\n                index: match.index,\r\n                original: fullMatch,\r\n                replaced: replacementValue,\r\n              });\r\n            }\r\n          }\r\n          originalTexts.set(`${slideIdx}_${shapeIdx}`, replacements);\r\n        } catch (error) {}\r\n      }\r\n    }\r\n    console.log(\"originals: \", originalTexts);\r\n    addUndoButton();\r\n    await context.sync();\r\n  });\r\n}\r\n\r\nasync function undoReplaceLabels() {\r\n  await PowerPoint.run(async (context) => {\r\n    const slides = context.presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n\r\n    for (let slideIdx = 0; slideIdx < slides.items.length; slideIdx++) {\r\n      const slide = slides.items[slideIdx];\r\n      const shapes = slide.shapes;\r\n      shapes.load(\"items\");\r\n      await context.sync();\r\n\r\n      for (let shapeIdx = 0; shapeIdx < shapes.items.length; shapeIdx++) {\r\n        try {\r\n          const shape = shapes.items[shapeIdx];\r\n          shape.textFrame.load(\"textRange/text\");\r\n          await context.sync();\r\n\r\n          const textRange = shape.textFrame.textRange;\r\n          const key = `${slideIdx}_${shapeIdx}`;\r\n          const replacements = originalTexts.get(key);\r\n\r\n          if (replacements && replacements.length > 0) {\r\n            console.log(\"Replacemtns: \", replacements);\r\n\r\n            for (let i = replacements.length - 1; i >= 0; i--) {\r\n              const { index, original, replaced } = replacements[i];\r\n              const subRange = textRange.getSubstring(index, replaced.length);\r\n              subRange.text = original;\r\n            }\r\n          }\r\n        } catch {}\r\n      }\r\n    }\r\n    await context.sync();\r\n    originalTexts.clear();\r\n  });\r\n}\r\n\r\nfunction addUndoButton() {\r\n  const container = document.getElementById(\"inputContainer\");\r\n  let undoBtn = document.getElementById(\"undoButton\");\r\n  if (!undoBtn) {\r\n    if (originalTexts.size <= 0) {\r\n      return;\r\n    }\r\n    undoBtn = document.createElement(\"button\");\r\n    undoBtn.id = \"undoButton\";\r\n    undoBtn.type = \"button\";\r\n    undoBtn.className = \"inputButton\";\r\n    undoBtn.textContent = \"‚Ü©Ô∏è DESFER\";\r\n    undoBtn.onclick = async () => {\r\n      await undoReplaceLabels();\r\n    };\r\n\r\n    container.appendChild(undoBtn);\r\n  }\r\n}\r\n\r\nfunction createInputFields(labels) {\r\n  const container = document.getElementById(\"inputContainer\");\r\n  container.innerHTML = \"\";\r\n\r\n  labels.forEach((label, name) => {\r\n    if (label.dependsOn) return;\r\n    if (name.startsWith(\"#\")) return; // Skip custom labels (auto-filled)\r\n\r\n    const div = document.createElement(\"div\");\r\n    div.className = \"form-group\";\r\n\r\n    const labelEl = document.createElement(\"label\");\r\n    labelEl.setAttribute(\"for\", name);\r\n    if (name.startsWith(\"*\")) {\r\n      labelEl.textContent = name.substring(1);\r\n    } else {\r\n      labelEl.textContent = name;\r\n    }\r\n    div.appendChild(labelEl);\r\n\r\n    // Add file input for image labels (<<*name>>)\r\n    if (name.startsWith(\"*\")) {\r\n      const fileInput = document.createElement(\"input\");\r\n      fileInput.type = \"file\";\r\n      fileInput.id = name;\r\n      fileInput.name = name;\r\n      fileInput.accept = \"image/*\";\r\n      fileInput.required = true;\r\n      div.appendChild(fileInput);\r\n    } else if (Array.isArray(label.options)) {\r\n      const select = document.createElement(\"select\");\r\n      select.id = name;\r\n      select.className = \"selector\";\r\n      select.name = name;\r\n\r\n      label.options.forEach((opt) => {\r\n        const optionEl = document.createElement(\"option\");\r\n        optionEl.value = opt;\r\n        optionEl.textContent = opt;\r\n        select.appendChild(optionEl);\r\n      });\r\n\r\n      div.appendChild(select);\r\n    } else {\r\n      const input = document.createElement(\"input\");\r\n      input.type = \"text\";\r\n      input.id = name;\r\n      input.name = name;\r\n      input.required = true;\r\n      div.appendChild(input);\r\n    }\r\n\r\n    container.appendChild(div);\r\n  });\r\n\r\n  if (labels.size !== 0) {\r\n    const submit = document.createElement(\"button\");\r\n    submit.type = \"submit\";\r\n    submit.className = \"inputButton\";\r\n    submit.textContent = \"‚úÖ SUBSTITUIR\";\r\n    container.appendChild(submit);\r\n  } else {\r\n    const msg = document.createElement(\"p\");\r\n    msg.textContent = \"No s'ha trobat cap etiqueta.\";\r\n\r\n    container.appendChild(msg);\r\n  }\r\n  addUndoButton();\r\n}\r\n\r\nasync function getAllSlideTags() {\r\n  const tags = [];\r\n  await PowerPoint.run(async (context) => {\r\n    const slides = context.presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n    for (let i = 0; i < slides.items.length; i++) {\r\n      const slide = slides.items[i];\r\n      slide.tags.load(\"items\");\r\n      await context.sync();\r\n      for (const tag of slide.tags.items) {\r\n        if (tag.key === \"TOGGLE\") {\r\n          tags.push({ idx: i, tag: tag.value });\r\n          break;\r\n        }\r\n      }\r\n    }\r\n  });\r\n  return tags;\r\n}\r\n\r\nasync function handleNewSlideSubmit(event) {\r\n  event.preventDefault();\r\n\r\n  const input = document.getElementById(\"slideName\");\r\n  if (!input || !input.value.trim()) return;\r\n  const tagValue = input.value.trim();\r\n\r\n  await PowerPoint.run(async (context) => {\r\n    const slides = context.presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n\r\n    const selection = context.presentation.getSelectedSlides();\r\n    selection.load(\"items\");\r\n    await context.sync();\r\n\r\n    if (selection.items.length > 0) {\r\n      const selectedId = selection.items[0].id;\r\n      const slideIdx = slides.items.findIndex((s) => s.id === selectedId);\r\n      if (slideIdx !== -1) {\r\n        const slide = slides.items[slideIdx];\r\n        slide.tags.load(\"items\");\r\n        await context.sync();\r\n        slide.tags.delete(\"TOGGLE\");\r\n        slide.tags.add(\"TOGGLE\", tagValue);\r\n        await context.sync();\r\n      }\r\n    }\r\n  });\r\n\r\n  console.log(await getAllSlideTags());\r\n  input.value = \"\";\r\n  createToggleSlideForm();\r\n}\r\n\r\nasync function createToggleSlideForm() {\r\n  const container = document.getElementById(\"toggleSlideFormContainer\");\r\n  container.style.display = \"block\";\r\n  container.innerHTML = \"\";\r\n\r\n  const tags = await getAllSlideTags();\r\n\r\n  if (tags.length === 0) {\r\n    container.textContent = \"No tagged slides found.\";\r\n    return;\r\n  }\r\n\r\n  for (const { idx, tag } of tags) {\r\n    const div = document.createElement(\"div\");\r\n    div.style.display = \"flex\";\r\n    div.style.alignItems = \"center\";\r\n    div.style.justifyContent = \"space-between\";\r\n    div.style.marginBottom = \"8px\";\r\n\r\n    const labelWrapper = document.createElement(\"div\");\r\n    labelWrapper.style.display = \"flex\";\r\n\r\n    labelWrapper.style.gap = \"6px\";\r\n\r\n    const checkbox = document.createElement(\"input\");\r\n    checkbox.type = \"checkbox\";\r\n    checkbox.checked = false;\r\n    checkbox.className = \"checkmark\";\r\n    checkbox.id = `slideVisible_${idx}`;\r\n\r\n    const label = document.createElement(\"label\");\r\n    label.htmlFor = checkbox.id;\r\n    label.textContent = `${idx + 1}. ${tag}`;\r\n    label.style.whiteSpace = \"nowrap\";\r\n\r\n    labelWrapper.appendChild(checkbox);\r\n    labelWrapper.appendChild(label);\r\n\r\n    const deleteBtn = document.createElement(\"button\");\r\n    deleteBtn.type = \"button\";\r\n    deleteBtn.style.marginTop = \"12px\";\r\n    deleteBtn.textContent = \"‚ùå\";\r\n    deleteBtn.onclick = async () => {\r\n      await PowerPoint.run(async (context) => {\r\n        const slides = context.presentation.slides;\r\n        slides.load(\"items\");\r\n        await context.sync();\r\n        const slide = slides.items[idx];\r\n        slide.tags.load(\"items\");\r\n        await context.sync();\r\n        slide.tags.delete(\"TOGGLE\");\r\n      });\r\n      console.log(await getAllSlideTags());\r\n      await createToggleSlideForm();\r\n    };\r\n\r\n    div.appendChild(labelWrapper);\r\n    div.appendChild(deleteBtn);\r\n    container.appendChild(div);\r\n  }\r\n\r\n  const submit = document.createElement(\"button\");\r\n  submit.type = \"submit\";\r\n  submit.className = \"inputButton\";\r\n  submit.textContent = \"‚úÖ APLICAR\";\r\n  container.appendChild(submit);\r\n}\r\n\r\nasync function handleToggleSlideSubmit(event) {\r\n  event.preventDefault();\r\n\r\n  // Get all tags (slide indices with TOGGLE tag)\r\n  const tags = await getAllSlideTags();\r\n\r\n  // Collect indices of slides to keep (checked)\r\n  const slidesToKeep = [];\r\n  tags.forEach(({ idx }) => {\r\n    const checkbox = document.getElementById(`slideVisible_${idx}`);\r\n    if (checkbox && checkbox.checked) {\r\n      slidesToKeep.push(idx);\r\n    }\r\n  });\r\n\r\n  // Delete slides that are not checked\r\n  await PowerPoint.run(async (context) => {\r\n    const slides = context.presentation.slides;\r\n    slides.load(\"items\");\r\n    await context.sync();\r\n\r\n    // Build a set for fast lookup\r\n    const keepSet = new Set(slidesToKeep);\r\n\r\n    // Delete from last to first to avoid index shifting\r\n    for (let i = slides.items.length - 1; i >= 0; i--) {\r\n      // Only delete slides that have a TOGGLE tag and are not checked\r\n      const tagObj = tags.find((t) => t.idx === i);\r\n      if (tagObj && !keepSet.has(i)) {\r\n        slides.items[i].delete();\r\n      }\r\n    }\r\n    await context.sync();\r\n  });\r\n\r\n  // Refresh the form after deletion\r\n  await createToggleSlideForm();\r\n}\r\n\r\nfunction showError(msg) {\r\n  const container = document.getElementById(\"errorContainer\");\r\n\r\n  const id = String(Date.now());\r\n\r\n  const div = document.createElement(\"div\");\r\n  div.className = \"error-message\";\r\n  div.id = id;\r\n  div.textContent = `‚ö†Ô∏è ${msg}`;\r\n\r\n  const btn = document.createElement(\"button\");\r\n  btn.className = \"close-btn\";\r\n  btn.onclick = () => {\r\n    document.getElementById(id).style.display = \"none\";\r\n  };\r\n  btn.textContent = \"‚úñ\";\r\n\r\n  div.appendChild(btn);\r\n  container.appendChild(div);\r\n}\r\n\r\nfunction clearErrors() {\r\n  const container = document.getElementById(\"errorContainer\");\r\n  container.innerHTML = \"\";\r\n}\r\n","// Imports\nvar ___HTML_LOADER_IMPORT_0___ = new URL(\"./taskpane.css\", import.meta.url);\n// Module\nvar code = \" <!doctype html> <html> <head> <meta charset=\\\"UTF-8\\\"/> <meta http-equiv=\\\"X-UA-Compatible\\\" content=\\\"IE=Edge\\\"/> <meta name=\\\"viewport\\\" content=\\\"width=device-width,initial-scale=1\\\"/> <title>Plantilles PowerPoint</title> <\" + \"script src=\\\"https://appsforoffice.microsoft.com/lib/1/hosted/office.js\\\"><\" + \"/script> <link rel=\\\"stylesheet\\\" href=\\\"https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css\\\"/> <link href=\\\"\" + ___HTML_LOADER_IMPORT_0___ + \"\\\" rel=\\\"stylesheet\\\"/> </head> <body class=\\\"ms-font-m ms-welcome ms-Fabric\\\"> <div id=\\\"nav\\\"> <h2>Plantilles PowerPoint</h2> <img src=\\\"https://vilarriba.com/wp-content/uploads/2021/04/VR_logo_red.png\\\" alt=\\\"logo Vilar Riba\\\" width=\\\"40\\\" height=\\\"40\\\"/> </div> <button id=\\\"scanLabelsButton\\\" class=\\\"inputButton\\\">üîç BUSCAR</button> <div id=\\\"errorContainer\\\"></div> <div class=\\\"form-section\\\"> <button class=\\\"tablink\\\" onclick='openPage(\\\"labelsTab\\\",this,\\\"\\\")' id=\\\"defaultOpen\\\"> Etiquetes </button> <button class=\\\"tablink\\\" onclick='openPage(\\\"slideTab\\\",this,\\\"\\\")'>Diapositives</button> <div id=\\\"labelsTab\\\" class=\\\"tabcontent\\\"> <form id=\\\"labelForm\\\"> <div id=\\\"inputContainer\\\" class=\\\"inputContainer\\\"></div> </form> </div> <div id=\\\"slideTab\\\" class=\\\"tabcontent\\\"> <div style=\\\"border:2px\\\"> <button id=\\\"toggleFormBtn\\\" onclick=\\\"toggleFrom()\\\">+</button> <form id=\\\"newSlideForm\\\" style=\\\"display:none\\\"> <div id=\\\"newSlideFormContainer\\\" class=\\\"inputContainer\\\"> <label for=\\\"slideName\\\">NOM:</label> <input type=\\\"text\\\" id=\\\"slideName\\\" name=\\\"slideName\\\" value=\\\"\\\" required/><br/> <button type=\\\"submit\\\" id=\\\"SlideFormBtn\\\" class=\\\"inputButton\\\">AFEGIR</button> </div> </form> </div> <hr/> <form id=\\\"toggleSlideForm\\\"> <div id=\\\"toggleSlideFormContainer\\\"></div> </form> </div> </div> <\" + \"script>function toggleFrom(){var e=document.getElementById(\\\"newSlideForm\\\");const t=document.getElementById(\\\"toggleFormBtn\\\");\\\"none\\\"===e.style.display?(e.style.display=\\\"block\\\",t.textContent=\\\"-\\\"):(t.textContent=\\\"+\\\",e.style.display=\\\"none\\\")}function openPage(e,t,n){var l,a,o;for(a=document.getElementsByClassName(\\\"tabcontent\\\"),l=0;l<a.length;l++)a[l].style.display=\\\"none\\\";for(o=document.getElementsByClassName(\\\"tablink\\\"),l=0;l<o.length;l++)o[l].style.backgroundColor=\\\"\\\";document.getElementById(e).style.display=\\\"block\\\",t.style.backgroundColor=\\\"#0078d7\\\"}document.getElementById(\\\"defaultOpen\\\").click();const tagTypeSelect=document.getElementById(\\\"tagType\\\"),valueFieldContainer=document.getElementById(\\\"valueFieldContainer\\\");function updateValueField(){valueFieldContainer.innerHTML=\\\"\\\";const e=tagTypeSelect.value,t=document.createElement(\\\"label\\\");if(t.setAttribute(\\\"for\\\",\\\"tagValue\\\"),t.textContent=\\\"Valor\\\",valueFieldContainer.appendChild(t),\\\"BOOL\\\"===e){const e=document.createElement(\\\"select\\\");e.name=\\\"tagValue\\\",e.required=!0;const t=document.createElement(\\\"option\\\");t.value=\\\"true\\\",t.textContent=\\\"True\\\";const n=document.createElement(\\\"option\\\");n.value=\\\"false\\\",n.textContent=\\\"False\\\",e.appendChild(t),e.appendChild(n),valueFieldContainer.appendChild(e)}else{const e=document.createElement(\\\"input\\\");e.type=\\\"text\\\",e.name=\\\"tagValue\\\",e.placeholder=\\\"Tag Value\\\",e.required=!0,valueFieldContainer.appendChild(e)}}updateValueField(),tagTypeSelect.addEventListener(\\\"change\\\",updateValueField)<\" + \"/script> </body> </html> \";\n// Exports\nexport default code;"],"names":["__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","m","g","globalThis","this","Function","e","window","o","obj","prop","Object","prototype","hasOwnProperty","call","scriptUrl","importScripts","location","document","currentScript","tagName","toUpperCase","src","scripts","getElementsByTagName","length","i","test","Error","replace","p","b","baseURI","self","href","customLabelMap","any","Date","getFullYear","toString","mes","getMonth","dia","getDate","padStart","any_passat","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","y","G","v","a","d","bind","l","TypeError","done","value","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","defineProperty","enumerable","configurable","writable","_invoke","_slicedToArray","Array","isArray","_arrayWithHoles","next","push","_iterableToArrayLimit","_unsupportedIterableToArray","_nonIterableRest","_createForOfIteratorHelper","_n","F","s","_arrayLikeToArray","slice","constructor","name","from","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","findPattern","_x","_findPattern","_callee3","pattern","foundLabels","_context3","Map","PowerPoint","run","_ref2","_callee2","context","presentation","slides","_iterator2","_step2","slide","shapes","_iterator3","_step3","shape","text","matches","_iterator4","_step4","match","customLabelName","imageLabelName","labelName","dependsOn","dependentValues","options","key","_key","_key2","values","opts","_t2","_t3","_context2","load","sync","items","textFrame","textRange","_toConsumableArray","matchAll","console","log","concat","has","set","type","split","map","trim","err","_x6","scanLabels","_scanLabels","_callee4","_context4","clearErrors","validatedLabels","checkLabels","createToggleSlideForm","createInputFields","Office","onReady","getElementById","onclick","onsubmit","handleFormSubmit","handleNewSlideSubmit","handleToggleSlideSubmit","_step","_iterator","_step$value","label","startsWith","substring","showError","get","_x2","_handleFormSubmit","_callee5","event","labelMap","fileToBase64","filePromises","_context5","file","reject","reader","FileReader","onload","result","onerror","readAsDataURL","preventDefault","forEach","sourceInput","selectedIndex","fileInput","files","base64","input","all","replaceLabels","originalTexts","_x3","_replaceLabels","_callee7","_context7","clear","_ref3","_callee6","slideIdx","shapeIdx","replacements","fullMatch","replacementValue","_validatedLabels$get","sourceValue","sourceOptions","index","_context6","getSubstring","fill","setImage","original","replaced","indexOf","addUndoButton","_x7","undoReplaceLabels","_undoReplaceLabels","_callee9","_context9","_ref4","_callee8","_replacements$i","_context8","_x8","container","undoBtn","size","createElement","id","className","textContent","_callee","_context","appendChild","labels","innerHTML","div","labelEl","setAttribute","accept","required","select","opt","optionEl","submit","msg","getAllSlideTags","_getAllSlideTags","_callee1","tags","_context1","_ref5","_callee0","_iterator5","_step5","tag","_t6","_context0","idx","_x9","_x4","_handleNewSlideSubmit","_callee11","tagValue","_t7","_t8","_context11","_ref6","_callee10","selection","selectedId","_context10","getSelectedSlides","findIndex","delete","add","_x0","_createToggleSlideForm","_callee14","_iterator6","_step6","_loop","_t1","_context15","style","display","_step6$value","labelWrapper","checkbox","deleteBtn","_context14","alignItems","justifyContent","marginBottom","gap","checked","htmlFor","whiteSpace","marginTop","_callee13","_t9","_t0","_context13","_ref8","_callee12","_context12","_x1","_regeneratorValues","_x5","_handleToggleSlideSubmit","_callee16","slidesToKeep","_context18","_ref9","_ref0","_callee15","keepSet","_loop2","_context17","Set","_context16","find","_x10","String","now","btn","URL"],"sourceRoot":""}